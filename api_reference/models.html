

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>falkon.models &mdash; falkon 0.6.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="falkon.kernels" href="kernels.html" />
    <link rel="prev" title="API Reference" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> falkon
          

          
          </a>

          
            
            
              <div class="version">
                0.6.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#supported-platforms">Supported Platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#pytorch-and-cuda">PyTorch and CUDA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#intel-mkl">Intel MKL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#keops">KeOps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#installing">Installing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#testing-the-installation">Testing the installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../get_started.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../get_started.html#passing-options">Passing Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get_started.html#more-examples">More Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/simple_regression.html">Falkon Regression Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/simple_regression.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/simple_regression.html#Load-the-data">Load the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/simple_regression.html#Pre-process-the-data">Pre-process the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/simple_regression.html#Create-the-Falkon-model">Create the Falkon model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/simple_regression.html#Training-the-model">Training the model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/simple_regression.html#Evaluating-model-performance">Evaluating model performance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/logistic_falkon.html">Introducing Logistic Falkon</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/logistic_falkon.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/logistic_falkon.html#Load-the-data">Load the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/logistic_falkon.html#Split-into-training-and-test-sets">Split into training and test sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/logistic_falkon.html#Data-Preprocessing">Data Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/logistic_falkon.html#Define-the-Falkon-model">Define the Falkon model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/logistic_falkon.html#Define-Logistic-Falkon-model">Define Logistic Falkon model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/logistic_falkon.html#Train-both-models">Train both models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/logistic_falkon.html#Testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/logistic_falkon.html#Plot-predictions">Plot predictions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/hyperparameter_tuning.html">Hyperparameter Tuning with Falkon</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/hyperparameter_tuning.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/hyperparameter_tuning.html#Load-the-data">Load the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/hyperparameter_tuning.html#Split-into-training-and-test-sets">Split into training and test sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/hyperparameter_tuning.html#Data-Preprocessing">Data Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/hyperparameter_tuning.html#Search-for-the-optimal-parameters">Search for the optimal parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/hyperparameter_tuning.html#Evaluating-the-model">Evaluating the model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/hyperparameter_tuning.html#Plot-grid-search-results">Plot grid-search results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/performance_tuning.html">Training on the GPU</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">falkon.models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#falkon">Falkon</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logisticfalkon">LogisticFalkon</a></li>
<li class="toctree-l3"><a class="reference internal" href="#incorefalkon">InCoreFalkon</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kernels.html">falkon.kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="kernels.html#kernel">Kernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="kernels.html#radial-kernels">Radial kernels</a><ul>
<li class="toctree-l4"><a class="reference internal" href="kernels.html#gaussian-kernel">Gaussian kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="kernels.html#laplacian-kernel">Laplacian kernel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="kernels.html#dot-product-kernels">Dot-Product kernels</a><ul>
<li class="toctree-l4"><a class="reference internal" href="kernels.html#exponential-kernel">Exponential kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="kernels.html#polynomial-kernel">Polynomial kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="kernels.html#linear-kernel">Linear kernel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="options.html">falkon.options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="options.html#falkonoptions">FalkonOptions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gsc_losses.html">falkon.gsc_losses</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gsc_losses.html#loss">Loss</a></li>
<li class="toctree-l3"><a class="reference internal" href="gsc_losses.html#logistic-loss">Logistic loss</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="preconditioner.html">falkon.preconditioner</a><ul>
<li class="toctree-l3"><a class="reference internal" href="preconditioner.html#preconditioner">Preconditioner</a></li>
<li class="toctree-l3"><a class="reference internal" href="preconditioner.html#cholesky-preconditioners">Cholesky preconditioners</a><ul>
<li class="toctree-l4"><a class="reference internal" href="preconditioner.html#falkonpreconditioner">FalkonPreconditioner</a></li>
<li class="toctree-l4"><a class="reference internal" href="preconditioner.html#logisticpreconditioner">LogisticPreconditioner</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="optimization.html">falkon.optim</a><ul>
<li class="toctree-l3"><a class="reference internal" href="optimization.html#optimizer">Optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="optimization.html#conjugate-gradient-methods">Conjugate gradient methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="optimization.html#conjugategradient">ConjugateGradient</a></li>
<li class="toctree-l4"><a class="reference internal" href="optimization.html#falkonconjugategradient">FalkonConjugateGradient</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="outofcore.html">falkon.ooc_ops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="outofcore.html#gpu-cholesky">gpu_cholesky</a></li>
<li class="toctree-l3"><a class="reference internal" href="outofcore.html#gpu-lauum">gpu_lauum</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sparse.html">falkon.sparse</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sparse.html#sparsetensor">SparseTensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="sparse.html#sparse-operations">Sparse operations</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">falkon</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">API Reference</a> &raquo;</li>
        
      <li>falkon.models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api_reference/models.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-falkon.models">
<span id="falkon-models"></span><h1>falkon.models<a class="headerlink" href="#module-falkon.models" title="Permalink to this headline">¶</a></h1>
<div class="section" id="falkon">
<h2>Falkon<a class="headerlink" href="#falkon" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="falkon.models.Falkon">
<em class="property">class </em><code class="sig-prename descclassname">falkon.models.</code><code class="sig-name descname">Falkon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kernel</span><span class="p">:</span> <span class="n">falkon.kernels.kernel.Kernel</span></em>, <em class="sig-param"><span class="n">penalty</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">M</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">center_selection</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>falkon.center_selection.CenterSelector<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">'uniform'</span></em>, <em class="sig-param"><span class="n">maxiter</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">20</span></em>, <em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">error_fn</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>callable<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">error_every</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">FalkonOptions(keops_acc_dtype='auto', keops_sum_scheme='auto', keops_active='auto', chol_force_in_core=False, chol_force_ooc=False, chol_par_blk_multiplier=2, lauum_par_blk_multiplier=8, pc_epsilon_32=1e-05, pc_epsilon_64=1e-13, cpu_preconditioner=False, cg_epsilon_32=1e-07, cg_epsilon_64=1e-15, cg_tolerance=1e-07, cg_full_gradient_every=10, debug=False, use_cpu=False, max_gpu_mem=inf, max_cpu_mem=inf, compute_arch_speed=False, no_single_kernel=True, min_cuda_pc_size_32=10000, min_cuda_pc_size_64=30000, min_cuda_iter_size_32=300000000, min_cuda_iter_size_64=900000000, never_store_kernel=False)</span></em><span class="sig-paren">)</span><a class="headerlink" href="#falkon.models.Falkon" title="Permalink to this definition">¶</a></dt>
<dd><p>Falkon Kernel Ridge Regression solver.</p>
<p>This estimator object solves approximate kernel ridge regression problems with Nystroem
projections and a fast optimization algorithm as described in <a class="reference internal" href="#rd1707f83455d-1" id="id1">[1]</a>, <a class="reference internal" href="#rd1707f83455d-2" id="id2">[2]</a>.</p>
<p>Multiclass and multiple regression problems can all be tackled
with this same object, for example by encoding multiple classes
in a one-hot target matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>kernel</strong></dt><dd><p>Object representing the kernel function used for KRR.</p>
</dd>
<dt><strong>penalty</strong><span class="classifier">float</span></dt><dd><p>Amount of regularization to apply to the problem.
This parameter must be greater than 0.</p>
</dd>
<dt><strong>M</strong><span class="classifier">int</span></dt><dd><p>The number of Nystrom centers to pick. <cite>M</cite> must be positive,
and lower than the total number of training points. A larger
<cite>M</cite> will typically lead to better accuracy but will use more
computational resources.</p>
</dd>
<dt><strong>center_selection</strong><span class="classifier">str or falkon.center_selection.CenterSelector</span></dt><dd><p>The center selection algorithm. Implemented is only ‘uniform’
selection which can choose each training sample with the same
probability.</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier">int</span></dt><dd><p>The number of iterations to run the optimization for. Usually
fewer than 20 iterations are necessary, however this is problem
dependent.</p>
</dd>
<dt><strong>seed</strong><span class="classifier">int or None</span></dt><dd><p>Random seed. Can be used to make results stable across runs.
Randomness is present in the center selection algorithm, and in
certain optimizers.</p>
</dd>
<dt><strong>error_fn</strong><span class="classifier">callable or None</span></dt><dd><p>A function which can be called with targets and predictions as
arguments and returns the error of the predictions. This is used
to display the evolution of the error during the iterations.</p>
</dd>
<dt><strong>error_every</strong><span class="classifier">int or None</span></dt><dd><p>Evaluate the error (on training or validation data) every
<cite>error_every</cite> iterations. If set to 1 then the error will be
calculated at each iteration. If set to None, it will never be
calculated.</p>
</dd>
<dt><strong>options</strong><span class="classifier">FalkonOptions</span></dt><dd><p>Additional options used by the components of the Falkon solver. Individual options
are documented in <a class="reference internal" href="options.html#module-falkon.options" title="falkon.options"><code class="xref py py-mod docutils literal notranslate"><span class="pre">falkon.options</span></code></a>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="rd1707f83455d-1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Alessandro Rudi, Luigi Carratino, Lorenzo Rosasco, “FALKON: An optimal large
scale kernel method,” Advances in Neural Information Processing Systems 29, 2017.</p>
</dd>
<dt class="label" id="rd1707f83455d-2"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Giacomo Meanti, Luigi Carratino, Lorenzo Rosasco, Alessandro Rudi,
“Kernel methods through the roof: handling billions of points efficiently,”
arXiv:2006.10350, 2020.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Running Falkon on a random dataset</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel</span> <span class="o">=</span> <span class="n">falkon</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">GaussianKernel</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">options</span> <span class="o">=</span> <span class="n">FalkonOptions</span><span class="p">(</span><span class="n">use_cpu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Falkon</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="falkon.models.Falkon.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">Y</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">Xts</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Yts</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#falkon.models.Falkon.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the Falkon KRR model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">torch.Tensor (2D)</span></dt><dd><p>The tensor of training data, of shape [num_samples, num_dimensions].
If X is in Fortran order (i.e. column-contiguous) then we can avoid
an extra copy of the data.</p>
</dd>
<dt><strong>Y</strong><span class="classifier">torch.Tensor (1D or 2D)</span></dt><dd><p>The tensor of training targets, of shape [num_samples, num_outputs].
If X and Y represent a classification problem, Y can be encoded as a one-hot
vector.
If Y is in Fortran order (i.e. column-contiguous) then we can avoid an
extra copy of the data.</p>
</dd>
<dt><strong>Xts</strong><span class="classifier">torch.Tensor (2D) or None</span></dt><dd><p>Tensor of validation data, of shape [num_test_samples, num_dimensions].
If validation data is provided and <cite>error_fn</cite> was specified when
creating the model, they will be used to print the validation error
during the optimization iterations.
If Xts is in Fortran order (i.e. column-contiguous) then we can avoid an
extra copy of the data.</p>
</dd>
<dt><strong>Yts</strong><span class="classifier">torch.Tensor (1D or 2D) or None</span></dt><dd><p>Tensor of validation targets, of shape [num_test_samples, num_outputs].
If validation data is provided and <cite>error_fn</cite> was specified when
creating the model, they will be used to print the validation error
during the optimization iterations.
If Yts is in Fortran order (i.e. column-contiguous) then we can avoid an
extra copy of the data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>model: Falkon</dt><dd><p>The fitted model</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="logisticfalkon">
<h2>LogisticFalkon<a class="headerlink" href="#logisticfalkon" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="falkon.models.LogisticFalkon">
<em class="property">class </em><code class="sig-prename descclassname">falkon.models.</code><code class="sig-name descname">LogisticFalkon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kernel</span><span class="p">:</span> <span class="n">falkon.kernels.kernel.Kernel</span></em>, <em class="sig-param"><span class="n">penalty_list</span><span class="p">:</span> <span class="n">List<span class="p">[</span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">iter_list</span><span class="p">:</span> <span class="n">List<span class="p">[</span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">loss</span><span class="p">:</span> <span class="n"><a class="reference internal" href="gsc_losses.html#falkon.gsc_losses.Loss" title="falkon.gsc_losses.Loss">falkon.gsc_losses.Loss</a></span></em>, <em class="sig-param"><span class="n">M</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">center_selection</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>falkon.center_selection.CenterSelector<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">'uniform'</span></em>, <em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">error_fn</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>callable<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">error_every</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">FalkonOptions(keops_acc_dtype='auto', keops_sum_scheme='auto', keops_active='auto', chol_force_in_core=False, chol_force_ooc=False, chol_par_blk_multiplier=2, lauum_par_blk_multiplier=8, pc_epsilon_32=1e-05, pc_epsilon_64=1e-13, cpu_preconditioner=False, cg_epsilon_32=1e-07, cg_epsilon_64=1e-15, cg_tolerance=1e-07, cg_full_gradient_every=10, debug=False, use_cpu=False, max_gpu_mem=inf, max_cpu_mem=inf, compute_arch_speed=False, no_single_kernel=True, min_cuda_pc_size_32=10000, min_cuda_pc_size_64=30000, min_cuda_iter_size_32=300000000, min_cuda_iter_size_64=900000000, never_store_kernel=False)</span></em><span class="sig-paren">)</span><a class="headerlink" href="#falkon.models.LogisticFalkon" title="Permalink to this definition">¶</a></dt>
<dd><p>Falkon Logistic regression solver.</p>
<p>This estimator object solves approximate logistic regression problems with Nystroem
projections and a fast optimization algorithm as described in <a class="reference internal" href="#r39b93b60d7f4-1" id="id5">[1]</a>, <a class="reference internal" href="#r39b93b60d7f4-2" id="id6">[2]</a>.</p>
<p>This model can handle logistic regression, so it may be used in place of
<a class="reference internal" href="#falkon.models.Falkon" title="falkon.models.Falkon"><code class="xref py py-class docutils literal notranslate"><span class="pre">falkon.models.Falkon</span></code></a> (which uses the squared loss) when tackling binary
classification problems.</p>
<p>The algorithm works by repeated applications of the base falkon algorithm with decreasing
amounts of regularization; therefore the class accepts slightly different parameters from
<a class="reference internal" href="#falkon.models.Falkon" title="falkon.models.Falkon"><code class="xref py py-class docutils literal notranslate"><span class="pre">falkon.models.Falkon</span></code></a>: a <cite>penalty_list</cite> which should contain a list of decreasing
regularization amounts, and an <cite>iter_list</cite> which should specify for each application
of the base algorithm, how many CG iterations to use. For guidance on how to set these
parameters, see below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>kernel</strong></dt><dd><p>Object representing the kernel function used for KRR.</p>
</dd>
<dt><strong>penalty_list</strong><span class="classifier">List[float]</span></dt><dd><p>Amount of regularization to use for each iteration of the base algorithm. The length
of this list determines the number of base algorithm iterations.</p>
</dd>
<dt><strong>iter_list: List[int]</strong></dt><dd><p>Number of conjugate gradient iterations used in each iteration of the base algorithm.
The length of this list must be identical to that of <cite>penalty_list</cite>.</p>
</dd>
<dt><strong>loss: Loss</strong></dt><dd><p>This parameter must be set to an instance of <a class="reference internal" href="gsc_losses.html#falkon.gsc_losses.LogisticLoss" title="falkon.gsc_losses.LogisticLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">falkon.gsc_losses.LogisticLoss</span></code></a>,
initialized with the same kernel as this class.</p>
</dd>
<dt><strong>M</strong><span class="classifier">int</span></dt><dd><p>The number of Nystrom centers to pick. <cite>M</cite> must be positive,
and lower than the total number of training points. A larger
<cite>M</cite> will typically lead to better accuracy but will use more
computational resources.</p>
</dd>
<dt><strong>center_selection</strong><span class="classifier">str or falkon.center_selection.CenterSelector</span></dt><dd><p>The center selection algorithm. Implemented is only ‘uniform’
selection which can choose each training sample with the same
probability.</p>
</dd>
<dt><strong>seed</strong><span class="classifier">int or None</span></dt><dd><p>Random seed. Can be used to make results stable across runs.
Randomness is present in the center selection algorithm, and in
certain optimizers.</p>
</dd>
<dt><strong>error_fn</strong><span class="classifier">callable or None</span></dt><dd><p>A function which can be called with targets and predictions as
arguments and returns the error of the predictions. This is used
to display the evolution of the error during the iterations.</p>
</dd>
<dt><strong>error_every</strong><span class="classifier">int or None</span></dt><dd><p>Evaluate the error (on training or validation data) every
<cite>error_every</cite> iterations. If set to 1 then the error will be
calculated at each iteration. If set to None, it will never be
calculated.</p>
</dd>
<dt><strong>options</strong><span class="classifier">FalkonOptions</span></dt><dd><p>Additional options used by the components of the Falkon solver. Individual options
are documented in <a class="reference internal" href="options.html#module-falkon.options" title="falkon.options"><code class="xref py py-mod docutils literal notranslate"><span class="pre">falkon.options</span></code></a>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>A rule of thumb for setting the <cite>penalty_list</cite> is to keep in mind the desired final
regularization (1e-6 in the example above), and then create a short path of around three
iterations where the regularization is decreased down to the desired value. The decrease can
be of 10^2 or 10^3 at each step. Then a certain number of iterations at the desired
regularization may be necessary to achieve good performance.
The <cite>iter_list</cite> attribute  follows a similar reasoning: use 3 inner-steps for the first three
iterations where the regularization is decreased, and then switch to a higher number of
inner-steps (e.g. 8) for the remaining iterations.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r39b93b60d7f4-1"><span class="brackets"><a class="fn-backref" href="#id5">1</a></span></dt>
<dd><p>Ulysse Marteau-Ferey, Francis Bach, Alessandro Rudi, “Globally Convergent Newton Methods
for Ill-conditioned Generalized Self-concordant Losses,” NeurIPS 32, 2019.</p>
</dd>
<dt class="label" id="r39b93b60d7f4-2"><span class="brackets"><a class="fn-backref" href="#id6">2</a></span></dt>
<dd><p>Giacomo Meanti, Luigi Carratino, Lorenzo Rosasco, Alessandro Rudi,
“Kernel methods through the roof: handling billions of points efficiently,”
arXiv:2006.10350, 2020.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Running Logistic Falkon on a random dataset</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span><span class="p">[</span><span class="n">Y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span><span class="p">[</span><span class="n">Y</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel</span> <span class="o">=</span> <span class="n">falkon</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">GaussianKernel</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">options</span> <span class="o">=</span> <span class="n">FalkonOptions</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">LogisticFalkon</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> <span class="n">penalty_list</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                       <span class="n">iter_list</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">M</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="falkon.models.LogisticFalkon.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">Y</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">Xts</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Yts</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#falkon.models.LogisticFalkon.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the Falkon Kernel Logistic Regression model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">torch.Tensor (2D)</span></dt><dd><p>The tensor of training data, of shape [num_samples, num_dimensions].
If X is in Fortran order (i.e. column-contiguous) then we can avoid
an extra copy of the data.</p>
</dd>
<dt><strong>Y</strong><span class="classifier">torch.Tensor (1D or 2D)</span></dt><dd><p>The tensor of training targets, of shape [num_samples, num_outputs].
If X and Y represent a classification problem, Y can be encoded as a one-hot
vector.
If Y is in Fortran order (i.e. column-contiguous) then we can avoid an
extra copy of the data.</p>
</dd>
<dt><strong>Xts</strong><span class="classifier">torch.Tensor (2D) or None</span></dt><dd><p>Tensor of validation data, of shape [num_test_samples, num_dimensions].
If validation data is provided and <cite>error_fn</cite> was specified when
creating the model, they will be used to print the validation error
during the optimization iterations.
If Xts is in Fortran order (i.e. column-contiguous) then we can avoid an
extra copy of the data.</p>
</dd>
<dt><strong>Yts</strong><span class="classifier">torch.Tensor (1D or 2D) or None</span></dt><dd><p>Tensor of validation targets, of shape [num_test_samples, num_outputs].
If validation data is provided and <cite>error_fn</cite> was specified when
creating the model, they will be used to print the validation error
during the optimization iterations.
If Yts is in Fortran order (i.e. column-contiguous) then we can avoid an
extra copy of the data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>model: LogisticFalkon</dt><dd><p>The fitted model</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="incorefalkon">
<h2>InCoreFalkon<a class="headerlink" href="#incorefalkon" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="falkon.models.InCoreFalkon">
<em class="property">class </em><code class="sig-prename descclassname">falkon.models.</code><code class="sig-name descname">InCoreFalkon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kernel</span><span class="p">:</span> <span class="n">falkon.kernels.kernel.Kernel</span></em>, <em class="sig-param"><span class="n">penalty</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">M</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">center_selection</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>falkon.center_selection.CenterSelector<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">'uniform'</span></em>, <em class="sig-param"><span class="n">maxiter</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">20</span></em>, <em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">error_fn</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>callable<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">error_every</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">FalkonOptions(keops_acc_dtype='auto', keops_sum_scheme='auto', keops_active='auto', chol_force_in_core=False, chol_force_ooc=False, chol_par_blk_multiplier=2, lauum_par_blk_multiplier=8, pc_epsilon_32=1e-05, pc_epsilon_64=1e-13, cpu_preconditioner=False, cg_epsilon_32=1e-07, cg_epsilon_64=1e-15, cg_tolerance=1e-07, cg_full_gradient_every=10, debug=False, use_cpu=False, max_gpu_mem=inf, max_cpu_mem=inf, compute_arch_speed=False, no_single_kernel=True, min_cuda_pc_size_32=10000, min_cuda_pc_size_64=30000, min_cuda_iter_size_32=300000000, min_cuda_iter_size_64=900000000, never_store_kernel=False)</span></em><span class="sig-paren">)</span><a class="headerlink" href="#falkon.models.InCoreFalkon" title="Permalink to this definition">¶</a></dt>
<dd><p>In GPU core Falkon Kernel Ridge Regression solver.</p>
<p>This estimator object solves approximate kernel ridge regression problems with Nystroem
projections and a fast optimization algorithm as described in <a class="reference internal" href="#re390d6da2a0b-1" id="id9">[1]</a>, <a class="reference internal" href="#re390d6da2a0b-2" id="id10">[2]</a>.</p>
<p>Multiclass and multiple regression problems can all be tackled
with this same object, for example by encoding multiple classes
in a one-hot target matrix.</p>
<p>Compared to the base <cite>falkon.models.Falkon</cite> estimator, the <cite>InCoreFalkon</cite> estimator
is designed to work fully within the GPU, performing no data-copies between CPU and GPU. As
such, it is more constraining than the base estimator, but <strong>has better performance on smaller
problems</strong>.
In particular, the constraints are that:</p>
<blockquote>
<div><ul class="simple">
<li><p>the input data must be on a single GPU, when calling <cite>InCoreFalkon.fit</cite>;</p></li>
<li><p>the data, preconditioner, kernels, etc. must all fit on the same GPU.</p></li>
</ul>
</div></blockquote>
<p>Using multiple GPUs is not possible with this model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>kernel</strong></dt><dd><p>Object representing the kernel function used for KRR.</p>
</dd>
<dt><strong>penalty</strong><span class="classifier">float</span></dt><dd><p>Amount of regularization to apply to the problem.
This parameter must be greater than 0.</p>
</dd>
<dt><strong>M</strong><span class="classifier">int</span></dt><dd><p>The number of Nystrom centers to pick. <cite>M</cite> must be positive,
and lower than the total number of training points. A larger
<cite>M</cite> will typically lead to better accuracy but will use more
computational resources.</p>
</dd>
<dt><strong>center_selection</strong><span class="classifier">str or falkon.center_selection.CenterSelector</span></dt><dd><p>The center selection algorithm. Implemented is only ‘uniform’
selection which can choose each training sample with the same
probability.</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier">int</span></dt><dd><p>The number of iterations to run the optimization for. Usually
fewer than 20 iterations are necessary, however this is problem
dependent.</p>
</dd>
<dt><strong>seed</strong><span class="classifier">int or None</span></dt><dd><p>Random seed. Can be used to make results stable across runs.
Randomness is present in the center selection algorithm, and in
certain optimizers.</p>
</dd>
<dt><strong>error_fn</strong><span class="classifier">callable or None</span></dt><dd><p>A function which can be called with targets and predictions as
arguments and returns the error of the predictions. This is used
to display the evolution of the error during the iterations.</p>
</dd>
<dt><strong>error_every</strong><span class="classifier">int or None</span></dt><dd><p>Evaluate the error (on training or validation data) every
<cite>error_every</cite> iterations. If set to 1 then the error will be
calculated at each iteration. If set to None, it will never be
calculated.</p>
</dd>
<dt><strong>options</strong><span class="classifier">FalkonOptions</span></dt><dd><p>Additional options used by the components of the Falkon solver. Individual options
are documented in <a class="reference internal" href="options.html#module-falkon.options" title="falkon.options"><code class="xref py py-mod docutils literal notranslate"><span class="pre">falkon.options</span></code></a>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="re390d6da2a0b-1"><span class="brackets"><a class="fn-backref" href="#id9">1</a></span></dt>
<dd><p>Alessandro Rudi, Luigi Carratino, Lorenzo Rosasco, “FALKON: An optimal large
scale kernel method,” Advances in Neural Information Processing Systems 29, 2017.</p>
</dd>
<dt class="label" id="re390d6da2a0b-2"><span class="brackets"><a class="fn-backref" href="#id10">2</a></span></dt>
<dd><p>Giacomo Meanti, Luigi Carratino, Lorenzo Rosasco, Alessandro Rudi,
“Kernel methods through the roof: handling billions of points efficiently,”
arXiv:2006.10350, 2020.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Running Falkon on a random dataset</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel</span> <span class="o">=</span> <span class="n">falkon</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">GaussianKernel</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">options</span> <span class="o">=</span> <span class="n">FalkonOptions</span><span class="p">(</span><span class="n">use_cpu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">InCoreFalkon</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">preds</span><span class="o">.</span><span class="n">is_cuda</span>
</pre></div>
</div>
<dl class="py method">
<dt id="falkon.models.InCoreFalkon.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">Y</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">Xts</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">Yts</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#falkon.models.InCoreFalkon.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the Falkon KRR model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">torch.Tensor (2D)</span></dt><dd><p>The tensor of training data, of shape [num_samples, num_dimensions].
If X is in Fortran order (i.e. column-contiguous) then we can avoid
an extra copy of the data. Must be a CUDA tensor.</p>
</dd>
<dt><strong>Y</strong><span class="classifier">torch.Tensor (1D or 2D)</span></dt><dd><p>The tensor of training targets, of shape [num_samples, num_outputs].
If X and Y represent a classification problem, Y can be encoded as a one-hot
vector.
If Y is in Fortran order (i.e. column-contiguous) then we can avoid an
extra copy of the data. Must be a CUDA tensor.</p>
</dd>
<dt><strong>Xts</strong><span class="classifier">torch.Tensor (2D) or None</span></dt><dd><p>Tensor of validation data, of shape [num_test_samples, num_dimensions].
If validation data is provided and <cite>error_fn</cite> was specified when
creating the model, they will be used to print the validation error
during the optimization iterations.
If Xts is in Fortran order (i.e. column-contiguous) then we can avoid an
extra copy of the data. Must be a CUDA tensor.</p>
</dd>
<dt><strong>Yts</strong><span class="classifier">torch.Tensor (1D or 2D) or None</span></dt><dd><p>Tensor of validation targets, of shape [num_test_samples, num_outputs].
If validation data is provided and <cite>error_fn</cite> was specified when
creating the model, they will be used to print the validation error
during the optimization iterations.
If Yts is in Fortran order (i.e. column-contiguous) then we can avoid an
extra copy of the data. Must be a CUDA tensor.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>model: InCoreFalkon</dt><dd><p>The fitted model</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="kernels.html" class="btn btn-neutral float-right" title="falkon.kernels" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Giacomo Meanti

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>